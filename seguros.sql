CREATE TABLE CLIENTE(
ID_CLIENTE CHAR(4) CONSTRAINT CLIENTE_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT CLI_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT CLI_AP_NN NOT NULL,
AMATERNO VARCHAR2(50) ,
TELEFONO VARCHAR2(10),
CORREO VARCHAR2(50)
);
DROP TABLE CLIENTE;
ALTER TABLE CLIENTE MODIFY AMATERNO DEFAULT '*********';
ALTER TABLE CLIENTE MODIFY TELEFONO DEFAULT '*********';
ALTER TABLE CLIENTE MODIFY CORREO DEFAULT '*********';
INSERT INTO CLIENTE VALUES('C001','MANUEL','DURAN','CUEVAS','4921234567','MA@GMAIL.COM');
INSERT INTO CLIENTE VALUES('C002','ALEJANDO','DURAN','CUEVAS','4921234562','AL@GMAIL.COM');
INSERT INTO CLIENTE VALUES('C003','CHUMEL','DURAN','CUEVAS','4921234563','CH@GMAIL.COM');
INSERT INTO CLIENTE VALUES('C004','JORGEL','DURAN','CUEVAS','4921234564','JO@GMAIL.COM');
INSERT INTO CLIENTE VALUES('C005','JUAN','DURAN','CUEVAS','4921234565','JU@GMAIL.COM');
INSERT INTO CLIENTE VALUES('C006','DIEGO','RIVERA','RIVERA','7921234565','DIE@GMAIL.COM');
SELECT * FROM CLIENTE;

CREATE TABLE AUTOMOVIL(
ID_AUTOMOVIL CHAR(4) CONSTRAINT AUTOMOVIL_PK PRIMARY KEY,
MARCA VARCHAR2(50) CONSTRAINT AUT_MA_NN NOT NULL,
MODELO VARCHAR2(50) CONSTRAINT AUT_MO_NN NOT NULL
);
DROP TABLE AUTOMOVIL;
INSERT INTO AUTOMOVIL VALUES ('A001','NISSAN','ACORD 2000');
INSERT INTO AUTOMOVIL VALUES ('A002','NISSAN','TIDA 2000');
INSERT INTO AUTOMOVIL VALUES ('A003','CHEVROLET','CHEVY 2000');
INSERT INTO AUTOMOVIL VALUES ('A004','CHEVROLET','IBIZA 2000');
INSERT INTO AUTOMOVIL VALUES ('A005','TOYOTA','LOBO 2000');
INSERT INTO AUTOMOVIL VALUES ('A006','LAMBO','TORNADO');
SELECT * FROM AUTOMOVIL;

CREATE TABLE AGENTE_VENTAS(
ID_AGENTE_VENTAS CHAR(5) CONSTRAINT AGENTE_VENTAS_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT AGE_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT AGE_AP_NN NOT NULL,
AMATERNO VARCHAR2(50),
TELEFONO VARCHAR2(10),
CORREO VARCHAR2(50),
SALARIO NUMBER(5,0) CONSTRAINT AGE_SAL_NN NOT NULL CONSTRAINT AGE_SAL_CK CHECK (SALARIO>=12000 AND SALARIO<=20000)
);
DROP TABLE AGENTE_VENTAS;
ALTER TABLE AGENTE_VENTAS MODIFY AMATERNO DEFAULT '*********';
ALTER TABLE AGENTE_VENTAS MODIFY TELEFONO DEFAULT '*********';
ALTER TABLE AGENTE_VENTAS MODIFY CORREO DEFAULT '*********';
INSERT INTO AGENTE_VENTAS VALUES('AV001','CRISTIANO','FLORES','VAZQUEZ','5921234567','CR@GMAIL.COM',12000);
INSERT INTO AGENTE_VENTAS VALUES('AV002','RONALDO','FLORES','VAZQUEZ','5921234562','RO@GMAIL.COM',12000);
INSERT INTO AGENTE_VENTAS VALUES('AV003','MESSI','FLORES','VAZQUEZ','5921234563','ME@GMAIL.COM',12000);
INSERT INTO AGENTE_VENTAS VALUES('AV004','NEYMAR','FLORES','VAZQUEZ','5921234564','NE@GMAIL.COM',12000);
INSERT INTO AGENTE_VENTAS VALUES('AV005','PELE','FLORES','VAZQUEZ','5921234565','PE@GMAIL.COM',12000);
INSERT INTO AGENTE_VENTAS VALUES('AV006','RAUL','REYES','REYES','9921234565','RA@GMAIL.COM',13000);
SELECT * FROM AGENTE_VENTAS;

CREATE TABLE TIPO_SEGURO(
ID_TIPO_SEGURO CHAR(4) CONSTRAINT TIPO_SEGURO_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT TS_NOM_NN NOT NULL,
PRECIO NUMBER (4,0) CONSTRAINT TS_PRE_NN NOT NULL
);
DROP TABLE TIPO_SEGURO;
INSERT INTO TIPO_SEGURO VALUES('S001','BASICO',1000);
INSERT INTO TIPO_SEGURO VALUES('S002','PROMEDIO',2000);
INSERT INTO TIPO_SEGURO VALUES('S003','EXTRA',2500);
INSERT INTO TIPO_SEGURO VALUES('S004','ULTRA',3000);
INSERT INTO TIPO_SEGURO VALUES('S005','PREMIUM',3500);
INSERT INTO TIPO_SEGURO VALUES('S006','DIAMANTE',4000);
SELECT * FROM TIPO_SEGURO;

CREATE TABLE AJUSTADOR(
ID_AJUSTADOR CHAR(5) CONSTRAINT AJUSTADOR_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT AJ_NOM_NN NOT NULL,
APATERNO VARCHAR2(50) CONSTRAINT AJ_AP_NN NOT NULL,
AMATERNO VARCHAR2(50),
TELEFONO VARCHAR2(10),
CORREO VARCHAR2(50),
SALARIO NUMBER(5,0) CONSTRAINT AJ_SAL_NN NOT NULL CONSTRAINT AJ_SAL_CK CHECK (SALARIO>=12000 AND SALARIO<=20000)
);
DROP TABLE AJUSTADOR;
ALTER TABLE AJUSTADOR MODIFY AMATERNO DEFAULT '*********';
ALTER TABLE AJUSTADOR MODIFY TELEFONO DEFAULT '*********';
ALTER TABLE AJUSTADOR MODIFY CORREO DEFAULT '*********';
INSERT INTO AJUSTADOR VALUES('AJ001','CAMACHO','MARQUEZ','VAZQUEZ','6921234567','CA@GMAIL.COM',12000);
INSERT INTO AJUSTADOR VALUES('AJ002','ROMEO','MARQUEZ','VAZQUEZ','6921234562','ROM@GMAIL.COM',12000);
INSERT INTO AJUSTADOR VALUES('AJ003','THIAGO','MARQUEZ','VAZQUEZ','6921234563','TH@GMAIL.COM',12000);
INSERT INTO AJUSTADOR VALUES('AJ004','LEO','MARQUEZ','VAZQUEZ','6921234564','LEO@GMAIL.COM',12000);
INSERT INTO AJUSTADOR VALUES('AJ005','HULK','MARQUEZ','VAZQUEZ','6921234565','HU@GMAIL.COM',12000);
INSERT INTO AJUSTADOR VALUES('AJ006','TONY','STARK','STARK','0921234565','STA@GMAIL.COM',15000);
SELECT * FROM AJUSTADOR;

CREATE TABLE TIPO_ACCIDENTE(
ID_TIPO_ACCIDENTE CHAR(4) CONSTRAINT TIPO_ACCIDENTE_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT TA_NOM_NN NOT NULL
);
DROP TABLE TIPO_ACCIDENTE;
INSERT INTO TIPO_ACCIDENTE VALUES('TA01','LEVE');
INSERT INTO TIPO_ACCIDENTE VALUES('TA02','MODERADO');
INSERT INTO TIPO_ACCIDENTE VALUES('TA03','GRAVE');
INSERT INTO TIPO_ACCIDENTE VALUES('TA04','MUY GRAVE');
INSERT INTO TIPO_ACCIDENTE VALUES('TA05','EXTREMO');
SELECT * FROM TIPO_ACCIDENTE;

CREATE TABLE TALLER(
ID_TALLER CHAR(4) CONSTRAINT TALLER_PK PRIMARY KEY,
NOMBRE VARCHAR2(50) CONSTRAINT TALL_NOM_NN NOT NULL,
DIRECCION VARCHAR2(50) CONSTRAINT TALL_DIR_NN NOT NULL
);
DROP TABLE TALLER;
INSERT INTO TALLER VALUES ('T001','TALLER EL VATO','EL ORITO ZAC. 121');
INSERT INTO TALLER VALUES ('T002','TALLER EL LOCO','GZALES ORTEGA ZAC. 21');
INSERT INTO TALLER VALUES ('T003','TALLER EL MATADOR','LAZARO CARDENAS ZAC. 101');
INSERT INTO TALLER VALUES ('T004','TALLER EL CHANEKE','COLOSIO ZAC. 12');
INSERT INTO TALLER VALUES ('T005','TALLER EL YISUS','TRES CRUCES ZAC. 2');
SELECT * FROM TALLER;

CREATE TABLE CLIENTE_AUTOMOVIL(
ID_CLIENTE CHAR(4),
ID_AUTOMOVIL CHAR(4),
FECHA DATE CONSTRAINT CA_FE_NN NOT NULL,
CONSTRAINT CLIENTE_AUTOMOVIL_PK PRIMARY KEY (ID_CLIENTE,ID_AUTOMOVIL,FECHA),
CONSTRAINT CLI_CA_FK FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE),
CONSTRAINT AUT_CA_FK FOREIGN KEY (ID_AUTOMOVIL) REFERENCES AUTOMOVIL(ID_AUTOMOVIL)
);
DROP TABLE CLIENTE_AUTOMOVIL;
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C001','A001','04-06-2020');
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C002','A002','04-06-2020');
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C003','A003','04-06-2020');
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C004','A004','04-06-2020');
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C005','A005','04-06-2020');
INSERT INTO CLIENTE_AUTOMOVIL VALUES('C002','A006','04-06-2020');
SELECT * FROM CLIENTE_AUTOMOVIL;

CREATE TABLE POLIZA(
FOLIO_POLIZA CHAR(5) CONSTRAINT POLI_FO_NN NOT NULL,
ID_AGENTE_VENTAS CHAR(5),
ID_TIPO_SEGURO CHAR(4),
ID_CLIENTE CHAR(4),
ID_AUTOMOVIL CHAR(4),
FECHA DATE,
CONSTRAINT POLIZA_PK PRIMARY KEY (FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA),
CONSTRAINT AGE_POLI_FK FOREIGN KEY (ID_AGENTE_VENTAS) REFERENCES AGENTE_VENTAS(ID_AGENTE_VENTAS),
CONSTRAINT TS_POLI_FK FOREIGN KEY (ID_TIPO_SEGURO) REFERENCES TIPO_SEGURO(ID_TIPO_SEGURO),
CONSTRAINT CA_POLI_FK FOREIGN KEY (ID_CLIENTE,ID_AUTOMOVIL,FECHA) REFERENCES CLIENTE_AUTOMOVIL(ID_CLIENTE,ID_AUTOMOVIL,FECHA)

);
DROP TABLE POLIZA;
ALTER TABLE POLIZA ADD CONSTRAINT POLI_FP_UK UNIQUE(FOLIO_POLIZA);
INSERT INTO POLIZA VALUES('FP001','AV001','S001','C001','A001','04-06-2020');
INSERT INTO POLIZA VALUES('FP002','AV002','S002','C002','A002','04-06-2020');
INSERT INTO POLIZA VALUES('FP003','AV003','S003','C003','A003','04-06-2020');
INSERT INTO POLIZA VALUES('FP004','AV004','S004','C004','A004','04-06-2020');
INSERT INTO POLIZA VALUES('FP005','AV005','S005','C005','A005','04-06-2020');
INSERT INTO POLIZA VALUES('FP006','AV005','S005','C005','A005','04-06-2020');
INSERT INTO POLIZA VALUES('FP007','AV005','S005','C005','A005','04-06-2020');
INSERT INTO POLIZA VALUES('FP008','AV005','S005','C005','A005','04-06-2020');
SELECT * FROM POLIZA;

CREATE TABLE ACCIDENTE(
ID_ACCIDENTE CHAR(6) CONSTRAINT ACCI_IA_UK UNIQUE,
FOLIO_POLIZA CHAR(5),
ID_AGENTE_VENTAS CHAR(5),
ID_TIPO_SEGURO CHAR (4),
ID_CLIENTE CHAR(4),
ID_AUTOMOVIL CHAR(4),
FECHA DATE,
ID_AJUSTADOR CHAR(5),
ID_TIPO_ACCIDENTE CHAR(4),
CONSTRAINT ACCIDENTE_PK PRIMARY KEY (ID_ACCIDENTE,FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA,ID_AJUSTADOR,ID_TIPO_ACCIDENTE),
CONSTRAINT POLI_ACCI_FK FOREIGN KEY (FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA) REFERENCES POLIZA(FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA),
CONSTRAINT AJ_ACCI_FK FOREIGN KEY (ID_AJUSTADOR) REFERENCES AJUSTADOR(ID_AJUSTADOR),
CONSTRAINT TA_ACCI_FK FOREIGN KEY (ID_TIPO_ACCIDENTE) REFERENCES TIPO_ACCIDENTE(ID_TIPO_ACCIDENTE)
);
DROP TABLE ACCIDENTE;
INSERT INTO ACCIDENTE VALUES ('ACC001','FP001','AV001','S001','C001','A001','04-06-2020','AJ001','TA01');
INSERT INTO ACCIDENTE VALUES ('ACC002','FP002','AV002','S002','C002','A002','04-06-2020','AJ002','TA02');
INSERT INTO ACCIDENTE VALUES ('ACC003','FP003','AV003','S003','C003','A003','04-06-2020','AJ003','TA03');
INSERT INTO ACCIDENTE VALUES ('ACC004','FP004','AV004','S004','C004','A004','04-06-2020','AJ004','TA04');
INSERT INTO ACCIDENTE VALUES ('ACC005','FP005','AV005','S005','C005','A005','04-06-2020','AJ005','TA05');
SELECT * FROM ACCIDENTE;

CREATE TABLE REPARACION(
NUM_REPARACION CHAR(5) CONSTRAINT REPA_NR_UK UNIQUE,
ID_ACCIDENTE CHAR(6),
FOLIO_POLIZA CHAR(5),
ID_AGENTE_VENTAS CHAR(5),
ID_TIPO_SEGURO CHAR (4),
ID_CLIENTE CHAR(4),
ID_AUTOMOVIL CHAR(4),
FECHA DATE,
ID_AJUSTADOR CHAR(5),
ID_TIPO_ACCIDENTE CHAR(4),
ID_TALLER CHAR(4),
CONSTRAINT REPARACION_PK PRIMARY KEY (NUM_REPARACION,ID_ACCIDENTE,FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA,ID_AJUSTADOR,ID_TIPO_ACCIDENTE,ID_TALLER),
CONSTRAINT ACCI_REPA_FK FOREIGN KEY (ID_ACCIDENTE,FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA,ID_AJUSTADOR,ID_TIPO_ACCIDENTE) REFERENCES ACCIDENTE(ID_ACCIDENTE,FOLIO_POLIZA,ID_AGENTE_VENTAS,ID_TIPO_SEGURO,ID_CLIENTE,ID_AUTOMOVIL,FECHA,ID_AJUSTADOR,ID_TIPO_ACCIDENTE),
CONSTRAINT TALL_REPA_FK FOREIGN KEY (ID_TALLER) REFERENCES TALLER(ID_TALLER)
);
DROP TABLE REPARACION;
INSERT INTO REPARACION VALUES('RE001','ACC001','FP001','AV001','S001','C001','A001','04-06-2020','AJ001','TA01','T001');
INSERT INTO REPARACION VALUES('RE002','ACC002','FP002','AV002','S002','C002','A002','04-06-2020','AJ002','TA02','T002');
INSERT INTO REPARACION VALUES('RE003','ACC003','FP003','AV003','S003','C003','A003','04-06-2020','AJ003','TA03','T003');
INSERT INTO REPARACION VALUES('RE004','ACC004','FP004','AV004','S004','C004','A004','04-06-2020','AJ004','TA04','T004');
INSERT INTO REPARACION VALUES('RE005','ACC005','FP005','AV005','S005','C005','A005','04-06-2020','AJ005','TA05','T005');
SELECT * FROM REPARACION;

--1. Consultar los datos generales de todos los clientes
SELECT * FROM CLIENTE;
--2. Consultar los nombres completos de los agentes de venta en una sola columna
SELECT * FROM AGENTE_VENTAS;
--AQUI ESTAMOS USANDO LOS ALIAS PARA EL ENCABEZADO DE LA CONSULTA 
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE FROM AGENTE_VENTAS;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE NOMBRE_COMPLETO FROM AGENTE_VENTAS;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE AS AGENTE_VENTAS FROM AGENTE_VENTAS;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE "Nombre del agente" FROM AGENTE_VENTAS;
--3. Consultar el salario anual de los agentes de ventas
SELECT * FROM AGENTE_VENTAS;
SELECT APATERNO, AMATERNO, NOMBRE, SALARIO * 12 AS SALARIO_ANALUAL FROM AGENTE_VENTAS;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE "Nombre del agente", SALARIO * 12 AS SALARIO_ANALUAL FROM AGENTE_VENTAS;
--4. Consultar los datos generales de todos los vehiculos de una determinada marca
SELECT * FROM AUTOMOVIL;
--Con where podemos filtrar datos
SELECT * FROM AUTOMOVIL WHERE MARCA = 'NISSAN';
--5. Consultar los datos generales de los agentes de venta cuyo salario este entre 5000 y 10000
SELECT * FROM AGENTE_VENTAS;
-- Operadores tradicionales = < > >= <= <>
-- Between busca entre un rango de valores, fechas, caracteres
SELECT * FROM AGENTE_VENTAS WHERE SALARIO BETWEEN 5000 AND 10000;
--6. Consultar el total de polizas generadas
SELECT * FROM POLIZA;
SELECT COUNT(*) AS TOTAL_POLIZAS FROM POLIZA;
--FUNCIONES SUM() AVG() MAX() MIN()
--7. Consultar el total de clientes en cada municipio
SELECT * FROM CLIENTE;
ALTER TABLE CLIENTE ADD MUNICIPIO VARCHAR2(50);
UPDATE CLIENTE SET MUNICIPIO = 'ZACATECAS';
UPDATE CLIENTE SET MUNICIPIO = 'GUADALUPE' WHERE ID_CLIENTE = 'C002';
SELECT MUNICIPIO, COUNT(*) AS TOTAL FROM CLIENTE GROUP BY MUNICIPIO;
--8. Consultar el nombre completo de los clientes que tienen automovil
SELECT * FROM CLIENTE;
SELECT * FROM CLIENTE_AUTOMOVIL;
-- JOIN sirve para hacer uniones en ON especificamos como se relacionan fisicamente con las llaves foraneas
-- DISTINCT sirve para quitar los registros duplicados
SELECT DISTINCT APATERNO, AMATERNO, NOMBRE FROM CLIENTE C JOIN CLIENTE_AUTOMOVIL CA ON C.ID_CLIENTE = CA.ID_CLIENTE;
--9. Consultar el total de automoviles que tiene cada cliente
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL_AUTOS FROM CLIENTE C JOIN CLIENTE_AUTOMOVIL CA ON C.ID_CLIENTE = CA.ID_CLIENTE
GROUP BY APATERNO, AMATERNO, NOMBRE;
--10. Consultar el total de pólizas que ha vendido cada empleado
SELECT * FROM AGENTE_VENTAS;
SELECT * FROM POLIZA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS POLIZAS_VENDIDAS_EMPLEADOS 
FROM AGENTE_VENTAS AV JOIN POLIZA P ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS GROUP BY APATERNO, AMATERNO, NOMBRE;
--11.	Consultar el total de pólizas emitidas por cada tipo de seguro.
SELECT * FROM TIPO_SEGURO;
SELECT * FROM POLIZA;
SELECT TS.ID_TIPO_SEGURO, TS.NOMBRE, TS.PRECIO, COUNT(*) AS POLIZAS_EMITIDAS_SEGURO FROM TIPO_SEGURO TS
JOIN POLIZA P ON TS.ID_TIPO_SEGURO = P.ID_TIPO_SEGURO GROUP BY TS.ID_TIPO_SEGURO, TS.NOMBRE, TS.PRECIO;
--12. Consultar el nombre de los empleados que no han vendido pólizas
SELECT * FROM AGENTE_VENTAS;
SELECT * FROM POLIZA;
-- Aqui estamos haciendo una subconsulta
SELECT ID_AGENTE_VENTAS, APATERNO, AMATERNO, NOMBRE FROM AGENTE_VENTAS WHERE ID_AGENTE_VENTAS NOT IN (SELECT ID_AGENTE_VENTAS FROM POLIZA);

--13.	Consultar el nombre de los clientes que no tienen automóvil asignado.
SELECT * FROM CLIENTE;
SELECT * FROM AUTOMOVIL;
SELECT * FROM CLIENTE_AUTOMOVIL;
SELECT APATERNO || ' ' ||  AMATERNO || ' ' || NOMBRE AS CLIENTES_SIN_AUTO FROM CLIENTE
WHERE ID_CLIENTE NOT IN (SELECT ID_CLIENTE FROM CLIENTE_AUTOMOVIL);
--14. Consultar los datos generales de las polizas
SELECT * FROM POLIZA;
SELECT P.FOLIO_POLIZA AS POLIZA,
       C.ID_CLIENTE || ' ' || C.APATERNO || ' ' || C.AMATERNO || ' ' || C.NOMBRE AS CLIENTE,
       AV.ID_AGENTE_VENTAS || ' ' || AV.APATERNO || ' ' || AV.AMATERNO || ' ' || AV.NOMBRE AS AGENTE_VENTAS,
       TS.ID_TIPO_SEGURO || ' ' || TS.NOMBRE AS SEGURO,
       A.ID_AUTOMOVIL || ' ' || A.MARCA || ' ' || A.MODELO AS AUTOMOVIL
FROM CLIENTE C JOIN CLIENTE_AUTOMOVIL CA ON C.ID_CLIENTE = CA.ID_CLIENTE
                        JOIN AUTOMOVIL A ON A.ID_AUTOMOVIL = CA.ID_AUTOMOVIL
                        JOIN POLIZA P ON CA.ID_CLIENTE = P.ID_CLIENTE AND
                        P.ID_AUTOMOVIL = CA.ID_AUTOMOVIL
                        JOIN AGENTE_VENTAS AV ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS
                        JOIN TIPO_SEGURO TS ON TS.ID_TIPO_SEGURO = P.ID_TIPO_SEGURO;
--15.	Consultar el tipo de seguro que no se ha vendido.
SELECT * FROM TIPO_SEGURO;
SELECT * FROM POLIZA;
SELECT ID_TIPO_SEGURO || ' ' || NOMBRE  AS SEGUROS_SIN_VENDER FROM TIPO_SEGURO WHERE ID_TIPO_SEGURO NOT IN (SELECT ID_TIPO_SEGURO FROM POLIZA);
--16.	Consultar el total de accidentes que haya atendido cada ajustador.
SELECT * FROM AJUSTADOR;
SELECT * FROM ACCIDENTE;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE AS AJUSTADOR, COUNT(*) AS TOTAL_ACCIDENTES FROM AJUSTADOR AJ
JOIN ACCIDENTE ACC ON AJ.ID_AJUSTADOR = ACC.ID_AJUSTADOR GROUP BY APATERNO, AMATERNO, NOMBRE;
--17. Consultar los datos generales de los vehículos y en caso de que estén asegurados, mostrar los datos generales de las pólizas. 
SELECT * FROM AUTOMOVIL;
SELECT * FROM AUTOMOVIL A 
                LEFT OUTER JOIN CLIENTE_AUTOMOVIL CA ON A.ID_AUTOMOVIL = CA.ID_AUTOMOVIL
                LEFT OUTER JOIN POLIZA P ON CA.ID_AUTOMOVIL =  P.ID_AUTOMOVIL AND
                                  CA.ID_CLIENTE = P.ID_CLIENTE;
--18.	Consultar los datos generales de los ajustadores que no han atendido accidentes.
SELECT * FROM AJUSTADOR WHERE ID_AJUSTADOR NOT IN (SELECT ID_AJUSTADOR FROM ACCIDENTE);
--19.	Consultar el nombre completo de los clientes que no se han accidentado.
SELECT * FROM ACCIDENTE;
SELECT APATERNO || ' ' || AMATERNO || ' ' || NOMBRE AS CLIENTE_SIN_ACCIDENTES FROM CLIENTE
WHERE ID_CLIENTE NOT IN (SELECT ID_CLIENTE FROM ACCIDENTE);
--20.	Consultar los datos generales de los automóviles que más se ha accidentado.
SELECT * FROM AUTOMOVIL;
SELECT * FROM ACCIDENTE;
SELECT MARCA, MODELO, COUNT(*) AS ACCIDENTES FROM AUTOMOVIL A JOIN ACCIDENTE ACC ON A.ID_AUTOMOVIL = ACC.ID_AUTOMOVIL
GROUP BY MARCA, MODELO
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS ACCIDENTES FROM AUTOMOVIL A JOIN ACCIDENTE ACC ON A.ID_AUTOMOVIL = ACC.ID_AUTOMOVIL
GROUP BY MARCA, MODELO);
--21. Consultar el nombre completo de los clientes que más autos tienen
SELECT * FROM CLIENTE;
SELECT * FROM CLIENTE_AUTOMOVIL;
SELECT * FROM AUTOMOVIL;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL FROM CLIENTE C JOIN CLIENTE_AUTOMOVIL CA ON C.ID_CLIENTE = CA.ID_CLIENTE 
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS TOTAL FROM CLIENTE C JOIN CLIENTE_AUTOMOVIL CA ON C.ID_CLIENTE = CA.ID_CLIENTE GROUP BY APATERNO, AMATERNO, NOMBRE);
--22.	Consultar el nombre completo de los clientes que han tenido más de 2 seguros.
SELECT * FROM CLIENTE;
SELECT * FROM POLIZA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS CLIENTE FROM CLIENTE C JOIN POLIZA P ON C.ID_CLIENTE = P.ID_CLIENTE
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*)=2;
--23. Consultar el nombre del agente de ventas que más seguros ha vendido.
SELECT * FROM AGENTE_VENTAS;
SELECT * FROM POLIZA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL FROM AGENTE_VENTAS AV JOIN POLIZA P ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MAX(COUNT(*)) AS TOTAL FROM AGENTE_VENTAS AV JOIN POLIZA P ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS GROUP BY APATERNO, AMATERNO, NOMBRE);
--24.	Consultar el nombre completo del empleado que menos pólizas ha vendido.
SELECT * FROM AGENTE_VENTAS;
SELECT * FROM POLIZA;
SELECT APATERNO, AMATERNO, NOMBRE, COUNT(*) AS TOTAL FROM AGENTE_VENTAS AV JOIN POLIZA P ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS
GROUP BY APATERNO, AMATERNO, NOMBRE
HAVING COUNT(*) = (
SELECT MIN(COUNT(*)) AS TOTAL FROM AGENTE_VENTAS AV JOIN POLIZA P ON AV.ID_AGENTE_VENTAS = P.ID_AGENTE_VENTAS GROUP BY APATERNO, AMATERNO, NOMBRE);
--25.	Consultar el tipo de seguro menos vendido.
SELECT * FROM TIPO_SEGURO;
SELECT * FROM POLIZA;
SELECT NOMBRE, COUNT(*) AS TOTAL FROM TIPO_SEGURO TS JOIN POLIZA P ON TS.ID_TIPO_SEGURO = P.ID_TIPO_SEGURO
GROUP BY NOMBRE
HAVING COUNT(*) = (
SELECT MIN(COUNT(*)) AS TOTAL FROM TIPO_SEGURO TS JOIN POLIZA P ON TS.ID_TIPO_SEGURO = P.ID_TIPO_SEGURO GROUP BY NOMBRE);



